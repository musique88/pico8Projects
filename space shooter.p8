pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
--init/update/draw

function _init()
	actors = {}
	bullets = {}
	bkgstars = {}
	enemies = {}
	player = mkactor(64,1,1)
	add(actors, player)
	enemytimer=0
end

function _update()
	for a in all(actors)do
		a:update()
	end
	for b in all(bullets)do
		b:update()
	end
	if (enemytimer >= 60)then
		local enemy = mkenemy()
		add(enemies,enemy)
		enemytimer = 0
	end
	for e in all(enemies)do
		e:update()
	end
	enemytimer += 1
	mkstars()
	updatestars()
end

function _draw()
	cls()
	drawstars()
	for b in all(bullets)do
	 b:draw()
	end
	for a in all(actors)do
		a:draw()
	end
	for e in all(enemies)do
		e:draw()
	end
	print(enemytimer, 0,0)
	print(#enemies, 0, 8)
	print(coli, 0, 16)
end
-->8
--make functions

function mkactor(x,vx,s)
	local a ={
		x=x,
		vx=vx,
		s=s,
		ax=0.25,
		mvx=4,
		update = function(self)
			if (btn(0) and not (self.x < 1 )) then 
				if (self.vx>0) then
				 self.vx = -0.1 
				else
				 self.vx -= self.ax
				end
			elseif (btn(1) and not (self.x > 119)) then 
				if (self.vx <=0) then
				 self.vx = 0.1
				else
				 self.vx += self.ax
				end
			end
			if(self.vx<-self.mvx)self.vx = -self.mvx
			if(self.vx>self.mvx)self.vx = self.mvx
			self.x += self.vx
			if (self.x<0) self.x = 0
			if (self.x>120) self.x = 120
			if (btnp(4)) then
			 local b=mkbullet(self.x)
			 add(bullets, b)
			end
		end,
		draw = function(self)
			spr(self.s,self.x,100)
		end
	}
	return a
end

function mkbullet(x)
	local b={
		x=x,
		y=100,
		v=0.2,
		l=1,
		update = function(self)
			self.y -= self.v
			if(self.v<2) then
			self.v += 0.6
			elseif(self.v<3) then
			self.v += 0.1
			else
			self.v += 1
			end
			self.l = self.v/2
			if (self.y<0) del(bullets,self)
		end,
		draw = function(self)
			rectfill(self.x+3,self.y+3,self.x+4,self.y+4+(self.l),9)
		end
	}
	return b
end

function mkenemy()
	e = {
		x=rnd(128),
		y=0,
		d=rnd(2)-1,
		w= 8,
		h= 8,
		update = function(self)
			self.y += 2
			self.x += self.d
			--a l'aide antoine
			for b in all(bullet) do
				for e in all(enemies) do
					if collisionbullet(b,e) then
						del(enemies, e)
						coli = true
					end
				end
			end
		end,
		
		draw = function(self)
			spr(3,self.x,self.y)
		end
	}
	return e
end

function mkstars()
	local n = flr(rnd(1))
 for i = 0, n do
 	local x = flr(rnd(120))
 	local y = 0
 	local c
 	local speed = 1+(flr(rnd(10)))
 	if (speed< 3) then
 		c = 5
 	elseif (speed < 6) then
 	 c = 6
 	else
 		c = 7
 	end
		local l = ceil(speed * 0.5)
 	local xy = {x,y,l,speed,c}
 	add(bkgstars,xy)
 end
end	

function updatestars()
	for s in all(bkgstars) do
		s[2] += s[4]
		if (s[2]>= 128) del(bkgstars,s)
	end
end

function drawstars()
	for s in all(bkgstars) do
		rectfill(s[1],s[2],s[1],s[2]+s[3],s[5])
	end
end
-->8
--utilz

function collisionbullet(bullet,object)
	if (bullet.y <= object.y and
					bullet.y >= (object.y+object.h)and
					bullet.x >= object.x and
					bullet.x <= (object.x+object.w)) then
	return true
	else
	return false
	end
end
__gfx__
00000000000000000000000000550000000070000000000000000000000000111c000000000000222e0000000000000000009999999900000000000000000000
000000000000000000000000055555000000700000700000007700000000111111cc00000000222222ee00000000000000999999999999000000000000000000
0070070000088000000000005555550000007000007000000077000000011111111cc00000022222222ee0000000000099999999999999990000000000000000
0007700000555500000000000555555000000000007000000000000000113111111ccc0000229222222eee000000009999999999999999999900000000000000
00077000055cc5500000000005555555000000000070000000000000011333331111ccc0022999992222eee00000099999999999999999999990000000000000
0070070055cccc550000000005555555000000000000000000000000011333331111ccc0022999992222eee00000999999999999999999999999000000000000
000000005555555500000000005555500000000000000000000000001113333311113bcc2229999922229aee0009999999999999999999999999900000000000
000000005099990500000000000550000000000000000000000000001111133311113bcc2222299922229aee0009999999999999999999999999900000000000
000000000000000000000000000000000000000000000000000000001111113311133bcc2222229922299aee0099999999999999999999999999990000000000
00000000000000000000000000000000000000000000000000000000111111311113bbcc222222922229aaee0099999999999999999999999999990000000000
00000000000000000000000000000000000000000000000000000000011111111113bcc0022222222229aee00999999999999999999999999999999000000000
00000000000000000000000000000000000000000000000000000000011111111111ccc0022222222222eee00999999999999999999999999999999000000000
0000000000000000000000000000000000000000000000000000000000111331111ccc0000222992222eee009999999999999999999999999999999900000000
0000000000000000000000000000000000000000000000000000000000011333111cc00000022999222ee0009999999999999999999999999999999900000000
000000000000000000000000000000000000000000000000000000000000111111cc00000000222222ee00009999999999999999999999999999999900000000
00000000000000000000000000000000000000000000000000000000000000111c000000000000222e0000009999999999999999999999999999999900000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000009999999999999999999999999999999900000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000009999999999999999999999999999999900000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000009999999999999999999999999999999900000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000009999999999999999999999999999999900000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000999999999999999999999999999999000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000999999999999999999999999999999000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000099999999999999999999999999990000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000099999999999999999999999999990000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009999999999999999999999999900000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009999999999999999999999999900000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000999999999999999999999999000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000099999999999999999999990000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009999999999999999999900000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000099999999999999990000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000999999999999000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009999999900000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000004000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000500000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000004040004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000040404000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000040004000004000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000040000000000000400000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000040000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000004000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
